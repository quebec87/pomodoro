let timerInt;const timerStateArr=["notask","working","break","done"];var timerState=timerStateArr[0];const workingDuration=.2,breakDuration=.1,workingDurationSec=60*workingDuration,breakDurationSec=60*breakDuration;let isPlaying=!1;const display=$(".time-display"),dialog=$(".dialog-info p"),iconDotHtml='<li class="icon-orange-dot"></li>';let taskArr,currentTask,currentTomato,totalTomato;const soundContext=new AudioContext;let isPlaySound=!0;function menuItemClicked(){$(".menuitem").click(function(){$(this).siblings().removeClass("active"),$(this).addClass("active"),openMenuPanel()})}function addTaskClicked(){$(".menuitem").eq(0).click()}function openMenuPanel(){$(".menupanel").hasClass("open")?showPanContent():($(".menupanel").addClass("open"),$(".main").addClass("menuopen"),showPanContent())}function showPanContent(){const t=$(".menuitem.active").index();$(".menupan-content").siblings().removeClass("show"),$(".menupan-content").eq(t).addClass("show")}function closeMenuPanel(){$(".menupanel").removeClass("open"),$(".main").removeClass("menuopen")}function setTomatoCount(){$("#Estimated-Tomato").change(function(){const t=$(".tomato-count>div");switch(t.removeClass(),$(this).val()){case"1":t.addClass("icon-orange-dot");break;case"2":t.addClass("icon-orange-dot-two");break;case"3":t.addClass("icon-orange-dot-three");break;case"4":t.addClass("icon-orange-dot-four");break;case"5":t.addClass("icon-orange-dot-five")}})}function addtaskSubmitted(t){t.preventDefault();var a=$("#Task-Name").val(),e=$("#Task-Date").val(),o=$("#Estimated-Tomato").val();""!=a?""!=e?""!=o?(storeTask(!0),clearForm(),closeMenuPanel(),timerState=timerStateArr[1],setClockState()):$("#Estimated-Tomato").addClass("alert"):$("#Task-Date").addClass("alert"):$("#Task-Name").addClass("alert")}function storeTask(t){var a=$("#Task-Name").val(),e=$("#Task-Date").val(),o=$("#Estimated-Tomato").val(),s=!1;let n={name:a=a,date:e=e,tomato:o=o,done:s=s};t&&(taskArr.push(n),currentTask=taskArr[taskArr.length-1],totalTomato=currentTask.tomato,currentTomato=1,setupTotalTomato(currentTask.tomato))}function clearForm(){$("#Task-Name").removeClass("alert"),$("#Task-Date").removeClass("alert"),$("#Estimated-Tomato").removeClass("alert"),$("#Task-Name").val("My Task"),$("#Task-Date").val(""),$("#Estimated-Tomato").val("1"),$(".tomato-count div").removeClass(),$(".tomato-count div").addClass("icon-orange-dot")}function setClockState(){switch(timerState){case timerStateArr[0]:$(".add-task-start").css("display","block"),$(".current-task").css("display","none"),$(".timer").removeClass("break"),$(".timer").addClass("notask"),display.html("Hello!<br>+");break;case timerStateArr[1]:$(".timer").removeClass("break"),$(".timer").removeClass("notask"),$(".timer").removeClass("done"),$(".add-task-start").css("display","none"),$(".current-task h2").html(currentTask.name),$(".current-task").css("display","block"),display.text(`${workingDuration}:00`);break;case timerStateArr[2]:$(".timer").addClass("break"),$(".timer").removeClass("notask"),$(".timer").removeClass("done"),display.text(`${breakDuration}:00`);break;case timerStateArr[3]:$(".timer").removeClass("break"),$(".timer").addClass("done"),display.html("Done!")}}function setupTotalTomato(t){$(".current-task .total-tomato").empty();for(var a=0;a<t;a++)$(".current-task .total-tomato").append(iconDotHtml)}function playPauseClicked(){$(".btn-play-pause").hasClass("playing")?(isPlaying=!1,$(".btn-play-pause").removeClass("playing"),$(".outer-circle>circle").css("animation-play-state","paused")):($(".btn-play-pause").addClass("playing"),isPlaying=!0,null==timerInt&&(timerState==timerStateArr[1]?(startTimer(workingDurationSec,display),$(".outer-circle>circle").css("animation-duration",`${workingDurationSec}s`)):timerState==timerStateArr[2]&&(startTimer(breakDurationSec,display),$(".outer-circle>circle").css("animation-duration",`${breakDurationSec}s`))),$(".outer-circle").addClass("start"),$(".outer-circle>circle").css("animation-play-state","running"))}function resetClicked(){null!=timerInt&&(window.clearInterval(timerInt),timerInt=void 0,isPlaying=!1,$(".btn-play-pause").removeClass("playing"),$(".outer-circle>circle").css("animation-play-state","paused"),$(".outer-circle").removeClass("start"),timerState==timerStateArr[1]?display.text(`${workingDuration}:00`):timerState==timerStateArr[2]&&display.text(`${breakDuration}:00`))}function startTimer(t,a){let e,o,s=t;timerInt=window.setInterval(()=>{if(1==isPlaying&&(e=parseInt(s/60,10),o=parseInt(s%60,10),e=e<10?`0${e}`:e,o=o<10?`0${o}`:o,a.text(`${e}:${o}`),--s<=0))if(s=0,resetClicked(),1==isPlaySound&&beep(100,520,200),timerState==timerStateArr[1])timerState=timerStateArr[2],setClockState();else if(timerState==timerStateArr[2]){var t=currentTomato-1;if($(".total-tomato li").eq(t).addClass("done"),currentTomato==totalTomato)return timerState=timerStateArr[3],showDialog(),void setClockState();currentTomato++,timerState=timerStateArr[1],showDialog(),setClockState()}},1e3)}function showDialog(){switch(timerState){case timerStateArr[1]:dialog.html("Go for next tomato");break;case timerStateArr[3]:dialog.html("Good Job. Task is done.")}$(".dialog-info").addClass("show")}function playSoundBtnClicked(){$(".btn-sound").hasClass("off")?($(".btn-sound").removeClass("off"),isPlaySound=!0):($(".btn-sound").addClass("off"),isPlaySound=!1)}function beep(t,a,e){v=soundContext.createOscillator(),u=soundContext.createGain(),v.connect(u),v.frequency.value=a,v.type="square",u.connect(soundContext.destination),u.gain.value=.01*t,v.start(soundContext.currentTime),v.stop(soundContext.currentTime+.001*e)}$(document).ready(()=>{taskArr=[],menuItemClicked(),$("#Task-Date").datepicker(),$("#Task-List-Date").datepicker(),$("#Analytics-Date").datepicker(),setTomatoCount(),$("#Add-Task-Btn").on("click",addtaskSubmitted),$("main").on("click",function(t){t.target===this&&closeMenuPanel()}),$(".add-task-start .btn").on("click",addTaskClicked),$(".notask .time-display").on("click",addTaskClicked),$(".btn-play-pause").on("click",playPauseClicked),$(".btn-reset").on("click",resetClicked),$(".btn-ok").on("click",function(){$(".dialog-info").removeClass("show")}),$(".btn-sound").on("click",playSoundBtnClicked)});