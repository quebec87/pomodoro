let timerInt;const timerStateArr=["notask","working","break","done"];var timerState=timerStateArr[0];const workingDuration=.2,breakDuration=.1,workingDurationSec=60*workingDuration,breakDurationSec=60*breakDuration,totalPei=5;let timeGapArr=[workingDurationSec,workingDurationSec/5*4,workingDurationSec/5*3,workingDurationSec/5*2,workingDurationSec/5*1],isPlaying=!1;const display=$(".time-display"),dialog=$(".dialog-info p"),iconDotHtml='<li class="icon-orange-dot"></li>';let taskArr,currentTask,currentTomato,totalTomato;const soundContext=new AudioContext;let isPlaySound=!0;function menuItemClicked(){$(".menuitem").click(function(){$(this).siblings().removeClass("active"),$(this).addClass("active"),openMenuPanel()})}function addTaskClicked(){$(".menuitem").eq(0).click()}function openMenuPanel(){$(".menupanel").hasClass("open")?showPanContent():($(".menupanel").addClass("open"),$(".main").addClass("menuopen"),showPanContent())}function showPanContent(){const t=$(".menuitem.active").index();$(".menupan-content").siblings().removeClass("show"),$(".menupan-content").eq(t).addClass("show")}function closeMenuPanel(){$(".menupanel").removeClass("open"),$(".main").removeClass("menuopen")}function setTomatoCount(){$("#Estimated-Tomato").change(function(){const t=$(".tomato-count>div");switch(t.removeClass(),$(this).val()){case"1":t.addClass("icon-orange-dot");break;case"2":t.addClass("icon-orange-dot-two");break;case"3":t.addClass("icon-orange-dot-three");break;case"4":t.addClass("icon-orange-dot-four");break;case"5":t.addClass("icon-orange-dot-five")}})}function addtaskSubmitted(t){t.preventDefault();var e=$("#Task-Name").val(),a=$("#Task-Date").val(),o=$("#Estimated-Tomato").val();""!=e?""!=a?""!=o?(storeTask(!0),clearForm(),closeMenuPanel(),timerState=timerStateArr[1],setClockState()):$("#Estimated-Tomato").addClass("alert"):$("#Task-Date").addClass("alert"):$("#Task-Name").addClass("alert")}function storeTask(t){var e=$("#Task-Name").val(),a=$("#Task-Date").val(),o=$("#Estimated-Tomato").val(),i=!1;let r={name:e=e,date:a=a,tomato:o=o,done:i=i};t&&(taskArr.push(r),currentTask=taskArr[taskArr.length-1],totalTomato=currentTask.tomato,currentTomato=1,setupTotalTomato(currentTask.tomato))}function clearForm(){$("#Task-Name").removeClass("alert"),$("#Task-Date").removeClass("alert"),$("#Estimated-Tomato").removeClass("alert"),$("#Task-Name").val("My Task"),$("#Task-Date").val(""),$("#Estimated-Tomato").val("1"),$(".tomato-count div").removeClass(),$(".tomato-count div").addClass("icon-orange-dot")}function setClockState(){switch(timerState){case timerStateArr[0]:$(".add-task-start").css("display","block"),$(".current-task").css("display","none"),$(".timer").removeClass("break"),$(".timer").addClass("notask"),display.html("Hello!<br>+");break;case timerStateArr[1]:$(".timer").removeClass("break"),$(".timer").removeClass("notask"),$(".timer").removeClass("done"),$(".add-task-start").css("display","none"),$(".current-task h2").html(currentTask.name),$(".current-task").css("display","block");for(var t=0;t<4;t++)$(".pie"+t).css("opacity",.2*t+.2);display.text(`${workingDuration}:00`);break;case timerStateArr[2]:$(".timer").addClass("break"),$(".timer").removeClass("notask"),$(".timer").removeClass("done"),display.text(`${breakDuration}:00`);break;case timerStateArr[3]:$(".timer").removeClass("break"),$(".timer").addClass("done"),display.html("Done!")}}function setupTotalTomato(t){$(".current-task .total-tomato").empty();for(var e=0;e<t;e++)$(".current-task .total-tomato").append(iconDotHtml)}function playPauseClicked(){$(".btn-play-pause").hasClass("playing")?(isPlaying=!1,$(".btn-play-pause").removeClass("playing"),$(".outer-circle>circle").css("animation-play-state","paused")):($(".btn-play-pause").addClass("playing"),isPlaying=!0,null==timerInt&&(timerState==timerStateArr[1]?(startTimer(workingDurationSec,display),$(".outer-circle>circle").css("animation-duration",`${workingDurationSec}s`)):timerState==timerStateArr[2]&&(startTimer(breakDurationSec,display),$(".outer-circle>circle").css("animation-duration",`${breakDurationSec}s`))),$(".outer-circle").addClass("start"),$(".outer-circle>circle").css("animation-play-state","running"))}function resetClicked(){null!=timerInt&&(window.clearInterval(timerInt),timerInt=void 0,isPlaying=!1,$(".btn-play-pause").removeClass("playing"),$(".outer-circle>circle").css("animation-play-state","paused"),$(".outer-circle").removeClass("start"),timerState==timerStateArr[1]?display.text(`${workingDuration}:00`):timerState==timerStateArr[2]&&display.text(`${breakDuration}:00`))}function startTimer(t,e){let a,o,i=t;timerInt=window.setInterval(()=>{if(1==isPlaying&&(i--,a=parseInt(i/60,10),o=parseInt(i%60,10),a=a<10?`0${a}`:a,o=o<10?`0${o}`:o,e.text(`${a}:${o}`),checkTimeGap(i),i<=0))if(i=0,resetClicked(),1==isPlaySound&&beep(100,520,200),$(".pie0").css("opacity",.1),timerState==timerStateArr[1])timerState=timerStateArr[2],setClockState();else if(timerState==timerStateArr[2]){var t=currentTomato-1;if($(".total-tomato li").eq(t).addClass("done"),currentTomato==totalTomato)return timerState=timerStateArr[3],showDialog(),void setClockState();currentTomato++,timerState=timerStateArr[1],showDialog(),setClockState()}},1e3)}function checkTimeGap(t){return console.log("timeGap"+timeGapArr+"checkTimeGap"+t),t<timeGapArr[1]&&t>timeGapArr[2]?($(".pie4").css("opacity",.1),void $(".pie3").css("opacity",1)):t<timeGapArr[2]&&t>timeGapArr[3]?($(".pie3").css("opacity",.1),void $(".pie2").css("opacity",1)):t<timeGapArr[3]&&t>timeGapArr[4]?($(".pie2").css("opacity",.1),void $(".pie1").css("opacity",1)):t<timeGapArr[4]?($(".pie1").css("opacity",.1),void $(".pie0").css("opacity",1)):void(t<=0&&$(".pie0").css("opacity",.1))}function showDialog(){switch(timerState){case timerStateArr[1]:dialog.html("Go for next tomato");break;case timerStateArr[3]:dialog.html("Good Job. Task is done.")}$(".dialog-info").addClass("show")}function playSoundBtnClicked(){$(".btn-sound").hasClass("off")?($(".btn-sound").removeClass("off"),isPlaySound=!0):($(".btn-sound").addClass("off"),isPlaySound=!1)}function beep(t,e,a){v=soundContext.createOscillator(),u=soundContext.createGain(),v.connect(u),v.frequency.value=e,v.type="square",u.connect(soundContext.destination),u.gain.value=.01*t,v.start(soundContext.currentTime),v.stop(soundContext.currentTime+.001*a)}function getPie(){for(var t=$(".inner-circle").width(),e=Math.round(10*t)/10*.5,a=0,o={x:0,y:-e},i=0;i<totalPei;i++){a+=.2;var r=2*Math.PI*a,s={x:e*Math.sin(r),y:e*Math.cos(r)*-1};let t={x:s.x,y:s.y};var n={x:0,y:0};let l="M"+(o.x+e)+","+(o.y+e);o=t;let c=l+("A"+e+","+e+",0,0,1,"+(s.x+e)+","+(s.y+e))+("L"+(e+n.x)+","+(e+n.y))+"Z",m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",c),m.setAttribute("fill","#e46713"),m.setAttribute("class","pie"+i),$(".inner-circle").append(m)}}$(document).ready(()=>{taskArr=[],getPie(),menuItemClicked(),$("#Task-Date").datepicker(),$("#Task-List-Date").datepicker(),$("#Analytics-Date").datepicker(),setTomatoCount(),$("#Add-Task-Btn").on("click",addtaskSubmitted),$("main").on("click",function(t){t.target===this&&closeMenuPanel()}),$(".add-task-start .btn").on("click",addTaskClicked),$(".notask .time-display").on("click",addTaskClicked),$(".btn-play-pause").on("click",playPauseClicked),$(".btn-reset").on("click",resetClicked),$(".btn-ok").on("click",function(){$(".dialog-info").removeClass("show")}),$(".btn-sound").on("click",playSoundBtnClicked)});